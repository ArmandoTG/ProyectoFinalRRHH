
create database RRHHWEB1
go

use RRHHWEB1
go


create table vendedor
(
COD_VENDEDOR varchar(10),
DSC_50 varchar(50)
)


CREATE TABLE  CP_VENDEDOR
(
ID_CP_VENDEDOR INT IDENTITY(1,1),
Empresa VARCHAR(150),
CP VARCHAR(8),
FCH_DOC datetime,
Cliente VARCHAR(500),
UUNN VARCHAR(1),
Monto varchar(50),
MARGEN NUMERIC(10,2),
ImporteMargen varchar(50),
TEAM VARCHAR(5),
TP VARCHAR(25),
TC_D VARCHAR(25),
TipoMoneda VARCHAR(5),
EstadoCP varchar(30)
)


create table Facturas
(
CP varchar(8),
CLIENTE VARCHAR(350),
NFACTURA VARCHAR(25),
FEMISION VARCHAR(10),
FCANCEL VARCHAR(10),
VALORDEVENTA NUMERIC(10,2),
DEBEDOLAR NUMERIC(10,2),
HABERDOLAR NUMERIC(10,2),
DEBESOLES NUMERIC(10,2),
HABERSOLES NUMERIC(10,2),
ESTADO VARCHAR(20),
CONDICIONDEPAGO VARCHAR(50),
MONEDA VARCHAR(15)
)

insert into vendedor values
(
'WD','WILLIAM DYER MOLFINO'
)

insert into vendedor values
(
'RCS','ROLANDO CORONADO S.'
)


insert into vendedor values
(
'JAB','JULIO ABAD'
)






insert into CP_VENDEDOR
values(
'DATA','0841337','20150112','METRO DE LIMA LINEA 2 S.A.','S','1,900.00','7.92','150.48','RCS','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0841340','20150112','COSAPI S A','S','770.00','27.27','209.98','RCS','A','Privada','$','CANCELADO')

insert into CP_VENDEDOR
values(
'DATA','0841343','20150112','MOLITALIA S.A','P','1,877.03','7.85','147.35','RCS','A','Privada','$','CANCELADO')

insert into CP_VENDEDOR
values(
'DATA','0841402','20150116','TECSUR S.A.'	,'S','89.00','19.37','17.24','RCS','A','Privada','$','CANCELADO')

insert into CP_VENDEDOR
values(
'DATA','0841441','20150123','CSI RENTING PERU S.A.C.','P','35,943.36','4.16','1,495.24','RCS','G','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0841567','20150212','METRO DE LIMA LINEA 2 S.A.','S','484.85','15.00','72.73','RCS','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0841676','20150227','MOLITALIA S.A','P','1,262.00','15.61','197.00','RCS','A','Privada','$','CANCELADO')

insert into CP_VENDEDOR
values(
'DATA','0841612','20150219','COSAPI S A',	'P','3,600.00','26.97','970.92','RCS','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0841472','20150127','EMPRESA EDITORA EL COMERCIO S.A.','P','2,600.00','28.05','729.30','RCS','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0841707','20150310','CONSORCIO CONSTRUCTOR M2 LIMA','S','31,214.38','13.17','4,110.93','RCS','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA',	'0841545','20150209','COSAPI S A','P','6,392.00','21.64','1,383.23','RCS','A','Privada','$','PENDIENTE')



insert into CP_VENDEDOR
values(
'DATA','0841587','20150217','ATRACCIONES CONEY ISLAND S.A.C.','P','6,826.00','25.23','1,722.20','RCS','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0841626','20150224','MOLITALIA S.A','P','560.00','44.13','247.13','RCS','G','Privada','$','CANCELADO')



insert into CP_VENDEDOR
values(
'DATA','0841365','20150112','LUZ DEL SUR S.A.A.','S','2,252.00','17.84','401.76','RCS','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0842226','20150616','EDPYME MI CASITA S.A','P','8,813.00','22.13','1,950.32','WD','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0841993','20150430','VESALIO S.A.','P','4,375.00','27.75','1,214.06',	'WD','A','Privada','$','CANCELADO')



insert into CP_VENDEDOR
values(
'DATA','0842077','20150526','SALESLAND INTERNACIONAL S.A.','P','1,475.00','30.44','448.99','WD','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0842006','20150508','ASOCIACION REAL CLUB DE LIMA','P','570.00','36.22','206.45','WD','A','Privada','$','CANCELADO')


insert into CP_VENDEDOR
values(
'DATA','0842227','20150616','EDPYME MI CASITA S.A','P','308.00','35.06','107.98','WD','A','Privada','$','CANCELADO')







INSERT INTO Facturas
VALUES
(
'0841337','METRO DE LIMA LINEA 2 S.A.','01-004-0099546','15/01/2015','02/02/2015','1900.00','2242.00','2242.00','6856.04','6856.04','CANCELADO','FACTURACION A 30 DIAS','DOLARES'
)

INSERT INTO Facturas
VALUES
(
'0841340','COSAPI S A','01-004-0099543','15/01/2015','06/03/2015','770.00','908.60','908.60','2814.57','2814.57','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)


INSERT INTO Facturas
VALUES
(
'0841343','MOLITALIA S.A','01-004-0099589','20/01/2015','17/04/2015','1877.03','2214.90','2214.90','6915.81','6915.81','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)

INSERT INTO Facturas
VALUES
(
'0841402','TECSUR S.A.','01-004-0099620','21/01/2015','10/04/2015','89.00',	'105.02','105.02','326.93','326.93','CANCELADO','FACTURA A 60 DIAS','DOLARES'
)

INSERT INTO Facturas
VALUES
(
'0841441','CSI RENTING PERU S.A.C.','01-004-0103125','10/08/2015','31/12/2015','35943.36','156637.16','156637.16','534834.19','534834.19','CANCELADO',	'A 30 DIAS','DOLARES'
)


INSERT INTO Facturas
VALUES
(
'0841567','METRO DE LIMA LINEA 2 S.A.','01-004-0100295','20/02/2015','16/03/2015','484.85','572.12','572.12','1774.60','1774.60','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)


INSERT INTO Facturas
VALUES
(
'0841676','MOLITALIA S.A','01-004-0100674','10/03/2015','17/04/2015','1262.00','1489.16','1489.16','4662.57','4662.57','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)


INSERT INTO Facturas
VALUES
(
'0841612','COSAPI S A','01-004-0100493','26/02/2015','10/04/2015','3600.00','4248.00','4248.00','13241.01','13241.01','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)

INSERT INTO Facturas
VALUES
(
'0841472','EMPRESA EDITORA EL COMERCIO S.A.','01-004-0099908','28/01/2015','10/03/2015','2600.00','3068.00','3068.00','9510.80','9510.80','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)


INSERT INTO Facturas
VALUES
(
'0841707','CONSORCIOCONSTRUCTOR M2 LIMA','01-004-0101172','01/04/2015','25/05/2015','31214.38','34469.04','34469.04','108467.18','108467.18','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)


INSERT INTO Facturas
VALUES
(
'0841587','ATRACCIONES CONEY ISLAND S.A.C.','01-004-0100761','16/03/2015','21/04/2015','6826.00','8054.68','8054.68','25260.29','25260.29','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)



INSERT INTO Facturas
VALUES
(
'0841626','MOLITALIA S.A','01-004-0103894','01/10/2015','13/11/2015','560.00','660.80','660.80','2195.84','2195.84','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)


INSERT INTO Facturas
VALUES
(
'0841365','LUZ DEL SUR S.A.A.','01-004-0099560','16/01/2015','17/02/2015','2252.00','1267.32','1267.32','3899.42','3899.42','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)


INSERT INTO Facturas
VALUES
(
'0842226','EDPYME MI CASITA S.A','01-004-0103120','10/08/2015','14/08/2015','8813.00','10399.34','10399.34','33499.39','33499.39','CANCELADO','FACTURA A 30 DIAS','DOLARES')



INSERT INTO Facturas
VALUES
(
'0841993','VESALIO S.A.','01-004-0101736','12/05/2015','12/06/2015','4375.00','5162.50','5162.50','16285.62','16285.62','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)



INSERT INTO Facturas
VALUES
(
'0842077','SALESLAND INTERNACIONAL S.A.','01-004-0102651','09/07/2015','24/08/2015','1475.00','1740.50','1740.50','5687.78','5687.78','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)



INSERT INTO Facturas
VALUES
(
'0842006','ASOCIACION REAL CLUB DE LIMA','01-004-0101771','15/05/2015','03/07/2015','570.00','672.60','672.60','2134.36','2134.36','CANCELADO','FACTURA A 30 DIAS','DOLARES')




INSERT INTO Facturas
VALUES
(
'0842227',	'EDPYME MI CASITA S.A','01-004-0104691','23/11/2015','30/11/2015','308.00','363.44','363.44','1228.03','1228.03','CANCELADO','FACTURA A 30 DIAS','DOLARES'
)
go



create proc ListarVendedoresBUX
as
select COD_VENDEDOR,DSC_50 from vendedor

go

CREATE proc ListaCP_x_Vendedor_y_Rango_Fechas_3
(
@Vendedor varchar(3),
@FechaInicio varchar(10),
@FechaFin varchar(10)

)
as
select   
ID_CP_VENDEDOR ,Empresa,CP ,FCH_DOC,Cliente ,UUNN ,Monto ,MARGEN ,ImporteMargen,TEAM ,TP ,TC_D ,TipoMoneda ,EstadoCP 
from CP_VENDEDOR
where
( convert(varchar,FCH_DOC,112)  between CONVERT(varchar, convert(datetime,@FechaInicio,103),112)   and CONVERT(varchar, convert(datetime,@FechaFin,103),112)   )
and  TEAM=@Vendedor 

go



CREATE PROC SP_LISTA_FACTURAS_CP
@CP varchar(250)   
AS
SELECT 
cp AS NCP,	CLIENTE,	NFACTURA,	FEMISION,	FCANCEL,	VALORDEVENTA,	DEBEDOLAR,	HABERDOLAR,	DEBESOLES,	HABERSOLES,	ESTADO,	CONDICIONDEPAGO,	MONEDA
FROM Facturas WHERE CP=@CP
go